\chapter{Dronetag web infrastructure}\label{ch:dronetag-web-infrastructure}
This chapter describes all Dronetag web infrastructure and contains a detailed description of the web Dronetag platform.
It consists of the whole technical stack that ensures data providing.
Co-workers had to determine a convenient and reliable way of how to construct a useful architecture of infrastructure gradually.
It starts with an IoT module and frontend web client written in JavaScript, and it continues to implement WebSockets with alone Live Service based on a Kubernetes cluster.
Current parts of the stack are the following:
\begin{itemize}
    \item Load Balancer,
    \item OLP Message Broker,
    \item Message Queue,
    \item Backend,
    \item Frontend,
    \item Private API endpoint,
    \item Public API endpoint,
    \item Database Storage and
    \item Live Service.
\end{itemize}

\section{API separation}\label{sec:api-separation}
Due to security reasons, the web API divides into \textbf{Private} and \textbf{Public API} endpoints.
\textbf{Public API} is allowed to use by third-party consumers.

In further determination, this infrastructure divides into the \textbf{Staging} and \textbf{Production} environment.
Staging is for development and testing purposes, and it usually runs on the same version as Production.
Production is like a mirror of Staging.
The difference is that the Production environment contains a previous version of the software that is released.

\section{Docker deployment}\label{sec:docker-deployment}
Every web application in the stack is deployed and managed by \textbf{Docker}. %\cite{} TODO
It is the easiest way to develop and publish new version software.
Thanks to the \textbf{docker-compose} tool, we can have separated parts of the infrastructure.
In the case of more significant changes, we have to change only one module, and others are without changes.

\section{Kubernetes}\label{sec:kubernetes}
Some words about Kubernetes. %TODO


\input{chapters/main_content/dronetag_backend_analysis/backend_application}

\input{chapters/main_content/dronetag_backend_analysis/database_model}

\input{chapters/main_content/dronetag_backend_analysis/broker}

\input{chapters/main_content/dronetag_backend_analysis/communication_protocols.tex}

\begin{figure}
    \centering
    \includegraphics[scale=0.29, angle=90]{assets/infrastructure-diagram.png}
    \caption{Infrastructure diagram\cite{dataInfrastructure}}
    \label{fig:infrastracture-diagram}
\end{figure}
